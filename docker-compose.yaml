services:
  retrievalapimcpserver:
    image: hoshy99/copilot-mcp-server:latest
    container_name: copilot-mcp-server
    restart: unless-stopped

    environment:
      ASPNETCORE_URLS: "http://0.0.0.0:5192"

      # === Copilot Retrieval Settings ===
      GRAPH_TENANT_ID: "REPLACEME"
      GRAPH_CLIENT_ID: "REPLACEME"
      GRAPH_CLIENT_SECRET: "REPLACEME"
      GRAPH_LOGIN_HINT: "copilotServiceAccountUser@myO365Tenant.com"
      GRAPH_ALLOWED_UPN: "copilotServiceAccountUser@myO365Tenant.com"

      # Must match the public URL hosting your MCP server
      GRAPH_REDIRECT_URI: "http://localhost:5192/auth/callback"

      # 0 = real Graph API | 1 = mock mode for offline dev
      MOCK_COPILOT_RETRIEVAL: "0"

      # Used to generate auth URLs inside the MCP server
      PUBLIC_BASE_URL: "http://localhost:5192"

    ports:
      - "5192:5192"
